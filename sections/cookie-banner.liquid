{% schema %}
{
  "name": "Cookie Banner",
  "settings": [
    {
      "type": "textarea",
      "id": "text",
      "label": "Text",
      "default": "We use cookies to orchestrate your perfect experience."
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "Accept"
    }
  ],
  "presets": [
    {
      "name": "Cookie Banner"
    }
  ]
}
{% endschema %}

<div id="cookie-banner" class="cookie-banner hidden">
  <div class="page-width cookie-banner__content">
    <p class="cookie-banner__text">{{ section.settings.text }}</p>
    <button id="cookie-accept" class="cookie-banner__button">
      {{ section.settings.button_text }}
    </button>
  </div>
</div>

<style>
  .cookie-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #1a1a1a;
    border-top: 1px solid #D4AF37;
    padding: 1rem 0;
    z-index: 9999;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.5);
    transform: translateY(100%);
    transition: transform 0.5s ease-out;
  }

  .cookie-banner.visible {
    transform: translateY(0);
  }

  .cookie-banner.hidden {
    display: none;
  }

  .cookie-banner__content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .cookie-banner__text {
    color: #f5f5f5;
    margin: 0;
    font-family: "Inter", sans-serif;
    font-size: 0.9rem;
  }

  .cookie-banner__button {
    background-color: #D4AF37;
    color: #1a1a1a;
    border: none;
    padding: 0.5rem 1.5rem;
    border-radius: 4px;
    font-family: "Playfair Display", serif;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }

  .cookie-banner__button:hover {
    background-color: #b5952f;
    transform: translateY(-1px);
  }

  @media screen and (max-width: 749px) {
    .cookie-banner__content {
      flex-direction: column;
      text-align: center;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const banner = document.getElementById('cookie-banner');
    const acceptBtn = document.getElementById('cookie-accept');
    const cookieName = 'bespoke_cookie_consent';

    if (!document.cookie.split('; ').find(row => row.startsWith(cookieName + '='))) {
      banner.classList.remove('hidden');
      // Small delay to allow display:block to apply before transition
      setTimeout(() => {
        banner.classList.add('visible');
      }, 100);
    }

    acceptBtn.addEventListener('click', function() {
      banner.classList.remove('visible');
      setTimeout(() => {
        banner.classList.add('hidden');
      }, 500);
      
      // Set cookie for 1 year
      const date = new Date();
      date.setFullYear(date.getFullYear() + 1);
      document.cookie = `${cookieName}=true; path=/; expires=${date.toUTCString()}; SameSite=Lax`;
    });
  });
</script>
