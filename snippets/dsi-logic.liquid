<script>
    (function() {
        function initDSI() {
            
            // Get user_intent from URL
            const urlParams = new URLSearchParams(window.location.search);
            const rawIntent = urlParams.get('user_intent');
            

            // Get elements
            const headlineEl = document.getElementById('lp-headline');
            const subheadEl = document.getElementById('lp-subhead');
            

            // If no intent, use default
            if (!rawIntent) {
                updateContent(
                    "The Ultimate Anniversary Gift. <br><span class='text-gold italic'>Your Love Story, in a Song.</span>",
                    "Commission a Classically Trained Composer to write a custom song for your partner. Studio-quality. Delivered in as little as <span class='text-gold font-semibold'>24 hours</span>."
                );
                return;
            }

            const intent = decodeURIComponent(rawIntent).toLowerCase();
            localStorage.setItem('user_intent', intent); // Persist for Thank You page

            // Helper function to update content
            function updateContent(h1, h2) {
                if (headlineEl) headlineEl.innerHTML = h1;
                if (subheadEl) subheadEl.innerHTML = h2;
            }

            // PRIORITY 1: MILESTONE ANNIVERSARIES
            const firstAnniversary = ["1st", "first", "paper", "1 year", "one year", "1 yr"];
            if (firstAnniversary.some(k => intent.includes(k))) {
                updateContent(
                    "One Year Down. <br><span class='text-gold italic'>A Lifetime to Go.</span>",
                    "Paper is traditional. This is eternal. A custom song for your first anniversary."
                );
                return;
            }

            const tenthAnniversary = ["10th", "tenth", "tin", "aluminum", "10 year", "ten year", "10 yr", "decade"];
            if (tenthAnniversary.some(k => intent.includes(k))) {
                updateContent(
                    "A Decade of Love. <br><span class='text-gold italic'>One Defining Anthem.</span>",
                    "Ten years deserves more than tin. It deserves a legacy."
                );
                return;
            }

            const twentyFifthAnniversary = ["25th", "twenty fifth", "silver", "25 year", "twenty five year", "25 yr", "quarter century"];
            if (twentyFifthAnniversary.some(k => intent.includes(k))) {
                updateContent(
                    "A Quarter Century. <br><span class='text-gold italic'>Immortalized.</span>",
                    "Silver sits in a drawer. This melody lives in the air between you."
                );
                return;
            }

            const fiftiethAnniversary = ["50th", "fiftieth", "gold", "golden", "50 year", "fifty year", "50 yr", "half century"];
            if (fiftiethAnniversary.some(k => intent.includes(k))) {
                updateContent(
                    "Golden Era. <br><span class='text-gold italic'>Immortalized.</span>",
                    "Gold sits in a drawer. This melody lives in the air between you."
                );
                return;
            }

            // PRIORITY 2: JEWELRY KILLER
            const jewelryKeywords = [
                "jewelry", "jewlery", "jewelery", "necklace", "neclace", "ring", "diamond", "dimond", 
                "earrings", "earings", "bracelet", "braclet", "pendant", "gem", "stone"
            ];
            if (jewelryKeywords.some(keyword => intent.includes(keyword))) {
                updateContent(
                    "Better Than Diamond Earrings. <br><span class='text-gold italic'>Ready Tomorrow.</span>",
                    "Jewelry is cold. A custom song is forever. The ultimate anniversary gesture, composed by a world-class artist and delivered in 24 hours."
                );
                return;
            }

            // PRIORITY 3: LOGISTICAL PANIC
            const panicKeywords = [
                "same day", "sameday", "tomorrow", "tmrw", "overnight", "rush", "24 hours", "24 hour", "24hr", 
                "urgent", "fast", "quick", "asap", "emergency", "last minute", "last min", "today"
            ];
            if (panicKeywords.some(keyword => intent.includes(keyword))) {
                updateContent(
                    "The Only Custom Gift <br><span class='text-gold italic'>Delivered Tomorrow.</span>",
                    "Commission a classically trained composer today. Receive a studio-quality song by tomorrow evening. 100% Guaranteed Delivery."
                );
                return;
            }

            // PRIORITY 4: FORGOTTEN / GUILT
            const guiltKeywords = [
                "forgot", "forgotten", "missed", "mist", "late", "apology", "appology", "doghouse", "dog house", 
                "sorry", "make up", "makeup", "screw up", "screwed up"
            ];
            if (guiltKeywords.some(keyword => intent.includes(keyword))) {
                updateContent(
                    "You Didn't Forget. <br><span class='text-gold italic'>You Were Waiting for a Masterpiece.</span>",
                    "A generic gift says you panicked. A custom song says you planned this for months. Written by a professional artist, delivered tomorrow."
                );
                return;
            }

            // PRIORITY 5: LUXURY / SKEPTIC
            const luxuryKeywords = [
                "luxury", "luxary", "expensive", "expencive", "premium", "high end", "high-end", "exclusive", 
                "bespoke", "custom", "top tier", "classy", "elegant", "best"
            ];
            if (luxuryKeywords.some(keyword => intent.includes(keyword))) {
                updateContent(
                    "Classically Trained Quality. <br><span class='text-gold italic'>Delivered in 24 Hours.</span>",
                    "Don't buy a generic jingle. Commission a professional composer with decades of discipline to write your love story. The ultimate luxury experience."
                );
                return;
            }

            // DEFAULT (Fallback)
            // Note: We leave the static HTML as is if no intent is found, 
            // or we can enforce the new CRO copy here to be safe.
            // Let's enforce the new CRO copy.
            updateContent(
                "The Ultimate Anniversary Gift. <br><span class='text-gold italic'>Your Love Story, in a Song.</span>",
                "Commission a Classically Trained Composer to write a custom song for your partner. Studio-quality. Delivered in as little as <span class='text-gold font-semibold'>24 hours</span>."
            );
        }

        // Run on page load
        if (document.readyState === "loading") {
            document.addEventListener("DOMContentLoaded", initDSI);
        } else {
            initDSI();
        }
    })();
</script>
